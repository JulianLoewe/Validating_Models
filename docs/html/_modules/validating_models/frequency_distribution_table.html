
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>validating_models.frequency_distribution_table &#8212; Validating Models  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../../index.html">
<p class="title">Validating Models</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../modules.html">
  validating_models
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for validating_models.frequency_distribution_table</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">FunctionType</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sn</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">dtreeviz.utils</span> <span class="kn">import</span> <span class="n">myround</span>

<span class="kn">from</span> <span class="nn">.checker</span> <span class="kn">import</span> <span class="n">Checker</span>
<span class="kn">from</span> <span class="nn">.constraint</span> <span class="kn">import</span> <span class="n">Constraint</span>
<span class="kn">from</span> <span class="nn">.drawing_utils</span> <span class="kn">import</span> <span class="n">PieChart</span><span class="p">,</span> <span class="n">StackedHistogram</span><span class="p">,</span> <span class="n">GroupedStackedHistogram</span><span class="p">,</span> <span class="n">Heatmap</span>
<span class="kn">from</span> <span class="nn">.colors</span> <span class="kn">import</span> <span class="n">get_cmap</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">lru_cache</span>

<span class="kn">from</span> <span class="nn">validating_models.stats</span> <span class="kn">import</span> <span class="n">get_decorator</span>
<span class="n">time_generate_histogram</span> <span class="o">=</span> <span class="n">get_decorator</span><span class="p">(</span><span class="s1">&#39;viz_hist&#39;</span><span class="p">)</span>
<span class="n">time_generate_piechart</span> <span class="o">=</span> <span class="n">get_decorator</span><span class="p">(</span><span class="s1">&#39;viz_pie&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="FrequencyDistributionTable"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable">[docs]</a><span class="k">class</span> <span class="nc">FrequencyDistributionTable</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39; Frequency distribution tables are used to summarize constraint validation results and visualize them accordingly. </span>

<span class="sd">    A table shows the different measurement categories and the number of observations per category. </span>
<span class="sd">    The measurement categories are constraints, the possible validation results and different groupings.</span>
<span class="sd">    The columns always have multiple hierachies, the first one refers to the different constraints and the second one to the different validation results (valid, invalid and not applicable).</span>
<span class="sd">    The index represents the division of the instances counted into the groups, when multiple group functions are given.</span>
<span class="sd">    </span>
<span class="sd">    Abstract definition of the function :math:`\mathcal{F}_{G,C}` used to create the frequency distribution table (without the coverage option):</span>
<span class="sd">    The function :math:`\mathcal{F}_{G,C}: \mathcal{P}([1,...,N]) \\times \mathbf{\Theta} \\times \mathbf{\Gamma} \\to \mathbb{N}^{|G| \\times |\{-1,0,1\}|}`, where</span>

<span class="sd">    * :math:`G` a set of arbitrary group identifiers</span>
<span class="sd">    * :math:`C` a constraint</span>
<span class="sd">    * :math:`N` the number of samples in the given dataset</span>
<span class="sd">    * :math:`\mathbf{\Gamma}` is the endless space of grouping function :math:`\Gamma: G \\to \mathcal{P}([1,...,N])`</span>

<span class="sd">    maps a subset of the indices :math:`D_{idx}` of a dataset :math:`D`, a model validation result function :math:`\Theta` and a grouping function :math:`\Gamma` to a frequency distribution table.</span>
<span class="sd">    :math:`\mathcal{F}_{G,C}(D_{idx},\Theta, \Gamma) \mapsto F_{G,\{-1,0,1\}}^{C,D_{idx}}`</span>
<span class="sd">    where</span>
<span class="sd">    </span>
<span class="sd">    * :math:`F_{G,\{-1,0,1\}}^{C,D_{idx}} = (|f_{g,v}^{C,D_{idx}}|)_{\substack{g \in G\\ v \in \{-1,0,1\}}}`</span>
<span class="sd">    * :math:`f_{g,v}^{C,D_{idx}} = \{ i | i \in (D_{idx} \cap \Gamma(g)) \land \Theta(C,i) = v\}`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    checker : validating_models.checker.Checker</span>
<span class="sd">        The checker instance to be used to get the constraint validation results.</span>
<span class="sd">    constraints : list of validating_models.constraint.Constraint</span>
<span class="sd">        The constraints to be checked.</span>
<span class="sd">    indices : list of int, optional</span>
<span class="sd">        A list of indices referring to samples in the dataset, which should be used while creating the frequency distribution table.</span>
<span class="sd">    group_functions : list of group function (see validating_models.groupings)</span>
<span class="sd">        The list of group functions defining the groups based on the checker and the given indices.</span>
<span class="sd">    coverage : bool</span>
<span class="sd">        Whether to use &quot;Coverage&quot; to only count the most important validation results. That is given that the grouping is non overlapping the entries of the frequency distribution table will sum to the number of indices given.</span>
<span class="sd">    non_applicable_counts : bool</span>
<span class="sd">        Whether to use non applicable counts. The semantics depends on the type of the constraint.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checker</span><span class="p">:</span> <span class="n">Checker</span><span class="p">,</span> <span class="n">constraints</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Constraint</span><span class="p">],</span> <span class="n">indices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">group_functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FunctionType</span><span class="p">],</span> <span class="n">all_indices_groups</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coverage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">non_applicable_counts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constraints</span> <span class="o">=</span> <span class="n">constraints</span>

        <span class="k">if</span> <span class="n">indices</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">checker</span><span class="o">.</span><span class="n">dataset</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span> <span class="o">=</span> <span class="n">indices</span>

        <span class="k">if</span> <span class="n">all_indices_groups</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_samples_overall</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_overall</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

            <span class="k">for</span> <span class="n">samples</span> <span class="ow">in</span> <span class="n">all_indices_groups</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_samples_overall</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span>
                    <span class="n">samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_samples_overall</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_samples_overall</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_overall</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span>
                    <span class="n">samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_overall</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_overall</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_samples_overall</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">checker</span><span class="o">.</span><span class="n">dataset</span><span class="p">)))</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_overall</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">group_functions</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">group_functions</span> <span class="o">=</span> <span class="p">[</span><span class="n">group_functions</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">=</span> <span class="n">checker</span><span class="o">.</span><span class="n">get_fdt</span><span class="p">(</span><span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">,</span> <span class="n">group_functions</span><span class="o">=</span><span class="n">group_functions</span><span class="p">,</span>
                                   <span class="n">coverage</span><span class="o">=</span><span class="n">coverage</span><span class="p">,</span> <span class="n">non_applicable_counts</span><span class="o">=</span><span class="n">non_applicable_counts</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_full_fdt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_coverage</span> <span class="o">=</span> <span class="n">coverage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_normalized</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_applicable_counts</span> <span class="o">=</span> <span class="n">non_applicable_counts</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">constraints_descriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_coverage</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Coverage&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Constraints&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">constraint_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_coverage</span><span class="p">:</span>
            <span class="c1"># In case of coverage the results are summarized as if there is a single constraint</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<div class="viewcode-block" id="FrequencyDistributionTable.group_names"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable.group_names">[docs]</a>    <span class="k">def</span> <span class="nf">group_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="n">level</span><span class="p">))</span></div>

<div class="viewcode-block" id="FrequencyDistributionTable.group_descriptor"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable.group_descriptor">[docs]</a>    <span class="k">def</span> <span class="nf">group_descriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="n">level</span><span class="p">]</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">categories_descriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_coverage</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Categories&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Validation Results&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">category_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_coverage</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">constraint</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">valres</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">constraint</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">valres</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">valres</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">columns</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<div class="viewcode-block" id="FrequencyDistributionTable.get_colors"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable.get_colors">[docs]</a>    <span class="nd">@lru_cache</span>
    <span class="k">def</span> <span class="nf">get_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">cmap_name</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="s1">&#39;g&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="s1">&#39;grey&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">cmap_name</span><span class="p">)(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">get_cmap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">cmap_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="FrequencyDistributionTable.remove_only_zeros_columns"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable.remove_only_zeros_columns">[docs]</a>    <span class="k">def</span> <span class="nf">remove_only_zeros_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="FrequencyDistributionTable.normalize"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable.normalize">[docs]</a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_normalized</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="FrequencyDistributionTable.denormalize"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable.denormalize">[docs]</a>    <span class="k">def</span> <span class="nf">denormalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_normalized</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="c1"># TODO: Generalize for multiple Constraints and normalized data</span>
<div class="viewcode-block" id="FrequencyDistributionTable.get_validation_result_summary"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable.get_validation_result_summary">[docs]</a>    <span class="k">def</span> <span class="nf">get_validation_result_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">number_of_samples</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">percentage_per_validation_result</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">_overall_summary</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">:</span>
                <span class="n">nsamples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nsamples</span> <span class="o">=</span> <span class="mf">1.0</span>

            <span class="n">invalid_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;invalid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">not_applicable_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="n">like</span><span class="o">=</span><span class="s1">&#39;not applicable&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;not covered&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">valid_count</span> <span class="o">=</span> <span class="n">nsamples</span> <span class="o">-</span> <span class="n">invalid_count</span> <span class="o">-</span> <span class="n">not_applicable_count</span>

            <span class="n">summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">valid_count</span><span class="p">,</span> <span class="n">invalid_count</span><span class="p">,</span> <span class="n">not_applicable_count</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                                   <span class="s1">&#39;Overall&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;valid&#39;</span><span class="p">,</span> <span class="s1">&#39;invalid&#39;</span><span class="p">,</span> <span class="s1">&#39;not applicable&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Validation Summary&#39;</span><span class="p">))</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="p">(</span><span class="n">summary</span> <span class="o">/</span> <span class="n">nsamples</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="k">return</span> <span class="n">summary</span>

        <span class="k">def</span> <span class="nf">_per_group_summary</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">_per_constraint_summary</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># # Identify what are the options for normalization: Constraint-Groups Combination</span>
        <span class="c1"># if self.is_coverage:</span>
        <span class="c1">#     column_agg = self.fdt.sum(axis=1)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     column_agg = self.fdt.groupby(axis=1,level=0).sum().iloc[:,0] # Counting the same indices per Constraint therefore taking the first is enough</span>

        <span class="c1"># return column_agg</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_coverage</span><span class="p">:</span>
            <span class="c1"># Check is per Group</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_overall_summary</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_per_group_summary</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_constraints</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_overall_summary</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_per_constraint_summary</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Check is per Group</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_overall_summary</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">_per_group_summary</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_overall_summary</span><span class="p">()</span></div>

    <span class="nd">@time_generate_piechart</span>
    <span class="k">def</span> <span class="nf">_visualize_with_piechart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="n">ncategories</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">category_names</span><span class="p">)</span>
        <span class="n">nconstraints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">figure_size</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">PieChart</span><span class="o">.</span><span class="n">get_height</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_samples_overall</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_overall</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>
            <span class="n">figure_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

        <span class="n">ngroups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">))</span>

        <span class="n">counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">PieChart</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span>
                        <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_validation_result_summary</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="n">nsamples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="n">nsamples</span><span class="si">}</span><span class="se">\n</span><span class="s2">Valid: </span><span class="si">{</span><span class="n">myround</span><span class="p">(</span><span class="n">summary</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">Invalid: </span><span class="si">{</span><span class="n">myround</span><span class="p">(</span><span class="n">summary</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;invalid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">Not applicable: </span><span class="si">{</span><span class="n">myround</span><span class="p">(</span><span class="n">summary</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;not applicable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">%&quot;</span>
        <span class="n">ncounts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
        <span class="n">cm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_colors</span><span class="p">(</span><span class="n">ncounts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncounts</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">ncategories</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">nconstraints</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ngroups</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ncategories</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constraints</span>
        <span class="k">elif</span> <span class="n">ngroups</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">nconstraints</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_names</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Frequency Distribution cannot be visualized with the a piechart&#39;</span><span class="p">)</span>

        <span class="n">plot</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot</span>
    
    <span class="nd">@time_generate_histogram</span>
    <span class="k">def</span> <span class="nf">_visualize_with_stacked_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="n">ncategories</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">category_names</span><span class="p">)</span>
        <span class="n">nconstraints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">)</span>
        <span class="n">ngroups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ncategories</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">nconstraints</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span>
            <span class="n">bar_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
            <span class="n">bar_labels_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_descriptor</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ngroups</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncategories</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
            <span class="n">bar_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span>
            <span class="n">bar_labels_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints_descriptor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Frequency Distribution cannot be visualized with the a stacked histogram&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">figure_size</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># StackedHistogram builds on GroupedStackedHistogram but without spaces between groups and 1 bar per group</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">StackedHistogram</span><span class="o">.</span><span class="n">get_width</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bar_labels</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">StackedHistogram</span><span class="o">.</span><span class="n">get_height</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_samples_overall</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_overall</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>
            <span class="n">figure_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nconstraints</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">ngroups</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">categorical_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">category_names</span>
            <span class="n">cm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_colors</span><span class="p">(</span><span class="n">ncategories</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncategories</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">ncategories</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">categorical_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span>
            <span class="n">cm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_colors</span><span class="p">(</span><span class="n">nconstraints</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nconstraints</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Frequency Distribution cannot be visualized with the a stacked histogram&#39;</span><span class="p">)</span>

        <span class="n">plot</span> <span class="o">=</span> <span class="n">StackedHistogram</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">bar_labels</span><span class="o">=</span><span class="n">bar_labels</span><span class="p">,</span> <span class="n">bar_labels_title</span><span class="o">=</span><span class="n">bar_labels_title</span><span class="p">,</span>
                  <span class="n">categorical_labels</span><span class="o">=</span><span class="n">categorical_labels</span><span class="p">,</span> <span class="n">categorical_colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;#samples&#39;</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot</span>

    <span class="k">def</span> <span class="nf">_visualize_with_grouped_stacked_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">figure_size</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">GroupedStackedHistogram</span><span class="o">.</span><span class="n">get_width</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">))</span> <span class="o">*</span> <span class="n">scale</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">GroupedStackedHistogram</span><span class="o">.</span><span class="n">get_height</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_samples_overall</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_overall</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>
            <span class="n">figure_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">category_names</span><span class="p">)))</span>  <span class="c1"># shape (#groups, #constraints, #categories)</span>

        <span class="c1"># shape (#categories, #groups, #constraints)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">category_names</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">array</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">)))</span> <span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">GroupedStackedHistogram</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">ncategories</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">category_names</span><span class="p">)</span>
        <span class="n">cm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_colors</span><span class="p">(</span><span class="n">ncategories</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncategories</span><span class="p">)]</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">bar_labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">,</span> <span class="n">bar_labels_title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints_descriptor</span><span class="p">,</span> <span class="n">group_labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level</span><span class="p">),</span>
                  <span class="n">group_labels_title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_descriptor</span><span class="p">(</span><span class="n">level</span><span class="p">),</span> <span class="n">categorical_labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">category_names</span><span class="p">,</span> <span class="n">categorical_colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;#samples&#39;</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot</span>

<div class="viewcode-block" id="FrequencyDistributionTable.matrix"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable.matrix">[docs]</a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s1">&#39;invalid&#39;</span><span class="p">,</span> <span class="n">fancy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s1">&#39;This function can only be applied if exactly 2 group functions were used during creation.&#39;</span>
            <span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s1">&#39;This function can only be applied, when visualizing exactly 1 constraint.&#39;</span>
            <span class="p">)</span>
        
        <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">select_category</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">,</span><span class="s1">&#39;invalid&#39;</span><span class="p">,</span><span class="s1">&#39;not applicable&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">select_category</span> <span class="o">=</span> <span class="p">[</span><span class="n">category</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_coverage</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">selected_columns</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">select_category</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selected_columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="n">select_category</span><span class="p">]</span>
        
        <span class="n">col_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_locs</span><span class="p">(</span><span class="n">selected_columns</span><span class="p">)</span>
        <span class="n">summarized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">col_loc</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_coverage</span><span class="p">:</span>
            <span class="n">summarized</span> <span class="o">=</span> <span class="n">summarized</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">summarized</span> <span class="o">=</span> <span class="n">summarized</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">index1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">index2</span> <span class="o">=</span> <span class="n">summarized</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">matrix_array</span> <span class="o">=</span> <span class="n">summarized</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">index2</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">matrix_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">index2</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index1</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">range</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="nb">max</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">max</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">fancy</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot</span> <span class="o">=</span> <span class="n">Heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">index2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;valid&#39;</span><span class="p">:</span>
                <span class="n">plot</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">sn</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;seagreen&quot;</span><span class="p">),</span> <span class="nb">range</span><span class="o">=</span><span class="nb">range</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;invalid&#39;</span><span class="p">:</span>
                <span class="n">plot</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">sn</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">),</span> <span class="nb">range</span><span class="o">=</span><span class="nb">range</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s1">&#39;not applicable&#39;</span><span class="p">:</span>
                <span class="n">plot</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">sn</span><span class="o">.</span><span class="n">light_palette</span><span class="p">(</span><span class="s2">&quot;grey&quot;</span><span class="p">),</span> <span class="nb">range</span><span class="o">=</span><span class="nb">range</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plot</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="nb">range</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plot</span></div>

<div class="viewcode-block" id="FrequencyDistributionTable.visualize"><a class="viewcode-back" href="../../validating_models.frequency_distribution_table.html#validating_models.frequency_distribution_table.FrequencyDistributionTable.visualize">[docs]</a>    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">selected_groups</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">level_to_visualize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aggregation_methode</span><span class="o">=</span><span class="s1">&#39;sum()&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s1">&#39;DejaVu Sans&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Automated visualiztion of the frequency distribution table for one grouping.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        title : str</span>
<span class="sd">            The title to use for the visualization.</span>
<span class="sd">        selected_groups : label, slice, list, mask or a sequence of such</span>
<span class="sd">            A selection of groups to be used. See pandas.MultiIndex.get_locs for examples.</span>
<span class="sd">        level_to_visualize : int</span>
<span class="sd">            The level (group) to be visualized. A pandas groupby is performed on the given level.</span>
<span class="sd">        aggregation_methode : string</span>
<span class="sd">            If there are multiple groupings the rest has to be aggregated.</span>
<span class="sd">        scale : float</span>
<span class="sd">            Scales the visualization accordingly, however it&#39;s recommended to scale the visualiation while saving to file.</span>
<span class="sd">        summary : bool</span>
<span class="sd">            Ignored (to be implemented in the feature)</span>
<span class="sd">        additional_text : str</span>
<span class="sd">            Ignored (to be implemented in the feature)</span>
<span class="sd">        figure_size : (int, int), optional</span>
<span class="sd">            The size of the visualisation to be created. Normally the figure size can be determined automatically, use in case it fails.</span>
<span class="sd">        type : A type, optional</span>
<span class="sd">            Force a specific type of visualization: Can be one of GroupedStackedHistogram, StackedHistogram or PieChart. See validating_models.drawing_utils.</span>
<span class="sd">        fontname : str, optional</span>
<span class="sd">            The font to be used</span>
<span class="sd">        fontsize : int, optional</span>
<span class="sd">            The size of the font to be used</span>
<span class="sd">        ax : matplotlib.axis, optional</span>
<span class="sd">            The axis to draw the visualization on.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="n">selected_groups</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selected_groups</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">nlevels</span><span class="p">)]</span>

        <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_locs</span><span class="p">(</span><span class="n">selected_groups</span><span class="p">)</span>

        <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsize</span> <span class="o">*</span> <span class="n">scale</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
                <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;self.fdt.&#39;</span> <span class="o">+</span> <span class="n">aggregation_methode</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="n">GroupedStackedHistogram</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
                    <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_grouped_stacked_histogram</span><span class="p">(</span>
                        <span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="n">StackedHistogram</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
                    <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_stacked_histogram</span><span class="p">(</span>
                        <span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="n">PieChart</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
                    <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_piechart</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span>
                                                         <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;The specified type of visualization (</span><span class="si">{</span><span class="nb">type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">) is not implemented.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="p">(</span><span class="n">level_to_visualize</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">category_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># Only One Entry</span>
                            <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_piechart</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span>
                                                                 <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Multiple Constraints</span>
                            <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_piechart</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span>
                                                                 <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># Multiple Categories</span>
                            <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_piechart</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span>
                                                                 <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Multiple constraints, multiple categories</span>
                            <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_stacked_histogram</span><span class="p">(</span>
                                <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">category_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># Multiple Groups</span>
                            <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_piechart</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span>
                                                                 <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Multiple Groups, multiple constraints</span>
                            <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_stacked_histogram</span><span class="p">(</span>
                                <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># Multiple groups, multiple categories</span>
                            <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_stacked_histogram</span><span class="p">(</span>
                                <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># Multiple groups, multiple categories, multiple constraints</span>
                            <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualize_with_grouped_stacked_histogram</span><span class="p">(</span>
                                <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="n">fontname</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">summary</span><span class="p">,</span> <span class="n">additional_text</span><span class="o">=</span><span class="n">additional_text</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level_to_visualize</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_fdt</span>
        <span class="k">return</span> <span class="n">plot</span></div>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">()</span></div>
</pre></div>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Julian Gercke.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>